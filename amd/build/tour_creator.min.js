/**
 * JavaScript for handling tour creation via button click.
 *
 * @module     block_course_audit/tour_creator
 * @copyright  2024 Your Name <your.email@example.com>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("block_course_audit/tour_creator",["jquery","core/ajax","core/notification","core/str","core/config"],(function($,Ajax,Notification,Str){const addMiauSprite=function(){const $miauWrapper=$("<div>").attr({id:"miau-wrapper",class:"slide-in"}),$speechBubble=$("<div>").attr({id:"miau-speech-bubble","aria-hidden":"true"}),$miauContainer=$("<div>").attr({id:"miau-gif","aria-hidden":"true",role:"presentation",tabindex:"0"}),$bubbleContainer=$("<div>").attr({id:"bubble-container","aria-hidden":"true",role:"presentation",style:"display: none;"});var $block;$speechBubble.append($("<div>").attr({id:"miau-speech-bubble-inner"})),$bubbleContainer.append($speechBubble),$miauContainer.append($bubbleContainer),$miauWrapper.append($miauContainer),$("#page").append($miauWrapper),setTimeout((function(){$("#miau-wrapper").css("opacity","1"),$("#miau-wrapper").removeClass("slide-in")}),2e3),$block=$("#block-course-audit"),$("#miau-speech-bubble").append($block),$block.show(),$miauWrapper.click((function(){triggerTalkAnimation(),$bubbleContainer.is(":visible")||$bubbleContainer.show()}))},triggerTalkAnimation=function(){$("#miau-gif").removeClass("miau-talk"),$("#miau-gif").addClass("miau-talk"),setTimeout((function(){$("#miau-gif").removeClass("miau-talk")}),8e3)};return{init:function(courseId){addMiauSprite(),$(".btn-minimize").on("click",(function(e){e.preventDefault(),e.stopPropagation(),$("#bubble-container").is(":visible")&&($("#miau-gif").removeClass("miau-talk"),$("#bubble-container").hide())})),$("#audit-start").on("click",(function(e){e.preventDefault();const $button=$(this),originalText=$button.text();$button.prop("disabled",!0),Str.get_string("creatingtour","block_course_audit").then((function(loadingText){return $button.text(loadingText),Ajax.call([{methodname:"block_course_audit_create_tour",args:{courseid:courseId}}])[0]})).then((function(response){var tourdata=response.tourdata;if(console.log("Extracted tourdata:",tourdata),!tourdata||!response.status){let errorMessage=response.message||"Unknown error creating tour data.";throw console.error("Tour creation failed:",errorMessage),new Error(errorMessage)}if(response.status)return console.log("Tour Details:",tourdata.tourDetails),console.log("Filter Names:",tourdata.filterNames),require(["tool_usertours/usertours"],(function(usertours){usertours.init(tourdata.tourDetails,tourdata.filterNames)})),Str.get_string("toursuccess","block_course_audit")})).then((function(successText){$button.text(successText)})).catch((function(error){Notification.exception(error),$button.text(originalText),$button.prop("disabled",!1)}))}))}}}));

//# sourceMappingURL=tour_creator.min.js.map